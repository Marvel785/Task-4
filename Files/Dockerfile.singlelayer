FROM springcommunity/spring-petclinic-rest

# Build configuration
ARG ENV=dev
ARG APP_VERSION=1.0

# Environment setup
ENV SPRING_PROFILES_ACTIVE=$ENV \
    APP_VERSION=$APP_VERSION

# Directory structure
WORKDIR /app

COPY . .

# Combined installation and cleanup
RUN apt-get update && \
    apt-get install -y curl vim && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Execution configuration
ENTRYPOINT ["java", "-jar", "spring-petclinic-rest.jar"]
CMD ["--server.port=8080"]
